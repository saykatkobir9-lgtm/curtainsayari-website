'use strict';var chunkVBUWRVZL_cjs=require('./chunk-VBUWRVZL.cjs'),react=require('react'),jsxRuntime=require('react/jsx-runtime'),shiki=require('shiki'),javascript=require('shiki/engine/javascript');var H=chunkVBUWRVZL_cjs.a("block","before:content-[counter(line)]","before:inline-block","before:[counter-increment:line]","before:w-4","before:mr-4","before:text-[13px]","before:text-right","before:text-muted-foreground/50","before:font-mono","before:select-none"),C=react.memo(({children:o,result:e,language:t,className:r,...n})=>{let l=react.useMemo(()=>({backgroundColor:e.bg,color:e.fg}),[e.bg,e.fg]);return jsxRuntime.jsx("pre",{className:chunkVBUWRVZL_cjs.a(r,"p-4 text-sm dark:bg-(--shiki-dark-bg)!"),"data-language":t,"data-streamdown":"code-block-body",style:l,...n,children:jsxRuntime.jsx("code",{className:"[counter-increment:line_0] [counter-reset:line]",children:e.tokens.map((a,i)=>jsxRuntime.jsx("span",{className:H,children:a.map((s,g)=>jsxRuntime.jsx("span",{className:"dark:bg-(--shiki-dark-bg)! dark:text-(--shiki-dark)!",style:{color:s.color,backgroundColor:s.bgColor,...s.htmlStyle},...s.htmlAttrs,children:s.content},g))},i))})})},(o,e)=>o.result===e.result&&o.language===e.language&&o.className===e.className);var y=({className:o,language:e,style:t,...r})=>jsxRuntime.jsx("div",{className:chunkVBUWRVZL_cjs.a("my-4 w-full overflow-hidden rounded-xl border border-border",o),"data-language":e,"data-streamdown":"code-block",style:{contentVisibility:"auto",containIntrinsicSize:"auto 200px",...t},...r});var x=({language:o,children:e})=>jsxRuntime.jsxs("div",{className:"flex items-center justify-between bg-muted/80 p-3 text-muted-foreground text-xs","data-language":o,"data-streamdown":"code-block-header",children:[jsxRuntime.jsx("span",{className:"ml-1 font-mono lowercase",children:o}),jsxRuntime.jsx("div",{className:"flex items-center gap-2",children:e})]});var M=javascript.createJavaScriptRegexEngine({forgiving:true}),p=new Map,h=new Map,d=new Map,$=(o,e)=>`${o}-${e[0]}-${e[1]}`,E=(o,e,t)=>{let r=o.slice(0,100),n=o.length>100?o.slice(-100):"";return `${e}:${t[0]}:${t[1]}:${o.length}:${r}:${n}`},A=(o,e)=>{let t=$(o,e);if(p.has(t))return p.get(t);let r=shiki.createHighlighter({themes:e,langs:[o],engine:M});return p.set(t,r),r},k=(o,e,t,r)=>{let n=E(o,e,t);return h.has(n)?h.get(n):(r&&(d.has(n)||d.set(n,new Set),d.get(n).add(r)),A(e,t).then(l=>{let a=l.codeToTokens(o,{lang:e,themes:{light:t[0],dark:t[1]}});h.set(n,a);let i=d.get(n);if(i){for(let s of i)s(a);d.delete(n);}}).catch(l=>{console.error("Failed to highlight code:",l),d.delete(n);}),null)};var le=({code:o,language:e,className:t,children:r,preClassName:n,...l})=>{let{shikiTheme:a}=react.useContext(chunkVBUWRVZL_cjs.h),i=react.useMemo(()=>({bg:"transparent",fg:"inherit",tokens:o.split(`
`).map(u=>[{content:u,color:"inherit",bgColor:"transparent",htmlStyle:{},offset:0}])}),[o]),[s,g]=react.useState(i);return react.useEffect(()=>{let u=k(o,e,a);if(u){g(u);return}k(o,e,a,R=>{g(R);});},[o,e,a]),jsxRuntime.jsx(chunkVBUWRVZL_cjs.b.Provider,{value:{code:o},children:jsxRuntime.jsxs(y,{language:e,children:[jsxRuntime.jsx(x,{language:e,children:r}),jsxRuntime.jsx(C,{className:t,language:e,result:s,...l})]})})};exports.CodeBlock=le;